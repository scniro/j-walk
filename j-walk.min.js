function jwException(r){Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=r}function jwHelper(){function r(r,e){function t(r,e){var t={};for(var n in r)t[n]=r[n];for(var n in e)t[n]=e[n];return t}function n(r,e,i,s){var a=e.shift();if(!a)return null;if(a&&e.length>0)r[a.property]=a.isArray?[]:{},n(r[a.property],e,i,s);else if(Array.isArray(r)){var o=t(i,s);r.push(o)}else r[a.property]=i;return r}return n({},r.undefined,e,r.queryProperties)}function e(r,e){var t=[],n={};r.slice(e.length,r.length).forEach(function(r){var e={property:null,isArray:!1,value:null};if(Array.isArray(r)){var i=r[0].split("=")[0],s=r[0].split("=")[1];n[i]=s,e.property=i}else e.property=r;t.push(e),Array.isArray(r)&&t.length>1&&(t[t.length-2].isArray=!0)});var i={queryProperties:n,undefined:t};return i}function t(r){if(!r||"string"!=typeof r)throw new jwException("j-walk: invalid selector query format. expected: string");for(var e=r.split("."),t=/\[(.*?)\]/,n=0;n<e.length;n+=1)if(e[n].match(t)){var i=e[n].split(t).filter(function(r){return""!==r});e[n]=i}return e||[]}return{constructNestedObject:r,getNestedMapping:e,parseQuery:t}}function jw(r){function e(r,e){function t(r){var e=n.shift();if(r.hasOwnProperty(e)&&n.length>0)t(r[e]);else{if(!Array.isArray(r))return i=r.hasOwnProperty(e);for(var s=n.shift(),a=e[0].split("=")[0],o=e[0].split("=")[1],u=0;u<r.length;u+=1)if(r[u][a]==o)return s?n.length>0?t(r[u][s]):i=r[u].hasOwnProperty(s):i=!0}}var n=engine.parseQuery(e),i=!1;return t(r),i}function t(r,e){function t(r){var e=i.shift();if(!Array.isArray(e))return r.hasOwnProperty(e)&&i.length>0?t(r[e]):n=r[e];for(var s=i.shift(),a=e[0].split("=")[0],o=e[0].split("=")[1],u=0;u<r.length;u+=1)if(r[u][a]==o)return i.length>0?t(r[u][s]):n=r[u][s]}var n,i=engine.parseQuery(e);return t(r),n}function n(r,e,t){function n(r,t){var a=i.shift();if(r.hasOwnProperty(a)&&!Array.isArray(r)&&i.length>0)s.push(a),0!==i.length&&n(r[a],t);else if(Array.isArray(r))for(var o=a[0].split("=")[0],u=a[0].split("=")[1],p=0;p<r.length;p+=1){var f=!1;if(r[p][o]==u){f=!0;var l=Object.keys(t);if(0!==i.length)return s.push(a),n(r[p],t);for(var c=0;c<l.length;c+=1)r[p][l[c]]=t[l[c]]}}else{var h=engine.getNestedMapping(engine.parseQuery(e),s),y=engine.constructNestedObject(h,t);y&&(r[a]=y[a])}}var i=engine.parseQuery(e),s=[];n(r,t)}if(!r||"object"!=typeof r)throw new jwException("j-walk: invalid selector. expected: object");var i=this;return i.exists=function(t){return e(r,t)},i.get=function(e){return t(r,e)},i.set=function(e,t){return n(r,e,t)},i}var engine=new jwHelper;module.exports.jw=jw,module.exports.jwHelper=jwHelper,module.exports.jwException=jwException;